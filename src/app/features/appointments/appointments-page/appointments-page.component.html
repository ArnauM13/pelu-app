<div class="container" [style.view-transition-name]="'appointments-container'">
  <!-- Full Screen Loading State -->
  @if (loading()) {
    <pelu-loading-state [config]="loadingConfig"> </pelu-loading-state>
  }

  <!-- Main Content -->
  @if (!loading()) {
    <div class="appointments-content">
      <!-- Next Appointment -->
      <div class="content-section">
        <pelu-next-appointment
          [bookings]="isAdmin() ? appointments() : userAppointments()"
        >
        </pelu-next-appointment>
      </div>

      <!-- Filters (admins only) -->
      @if (isAdmin()) {
        <div class="content-section">
          <pelu-filters-collapsible
            [stats]="appointmentStats()"
            [filterDate]="filterDate"
            [filterClient]="filterClient"
            [filterService]="filterService"
            [quickFilter]="quickFilterString()"
            [hasActiveFilters]="hasActiveFilters()"
            [onDateChange]="setFilterDate"
            [onClientChange]="setFilterClient"
            [onServiceChange]="setFilterService"
            [onReset]="clearAllFilters"
            (quickFilterChange)="setQuickFilter($event)"
          />
        </div>
      }



      <!-- Appointments List View -->
      <div class="content-section">
        <pelu-appointments-list
          [bookings]="listAppointments()"
          [hasActiveFilters]="isAdmin() ? hasActiveFilters() : false"
          [isSelectionMode]="isSelectionMode()"
          [selectedIds]="selectedIds()"
          [isAdmin]="isAdmin()"
          (viewBooking)="viewAppointmentDetail($event)"
          (deleteBooking)="deleteBookingFromList($event)"
          (clearFilters)="clearAllFilters()"
          (toggleSelection)="toggleAppointmentSelection($event)"
          (bulkDelete)="onBulkDeleteRequested($event)"
        >
        </pelu-appointments-list>
      </div>
    </div>

      <!-- View Mode Toggle (always visible)
      <pelu-appointments-view-controls
        [viewButtons]="viewButtons()"
        (viewModeChange)="setViewMode($event)"
      >
      </pelu-appointments-view-controls> -->

  }

  <!-- Confirmation Popup -->
  <pelu-confirmation-popup
    [isOpen]="confirmationPopup().isOpen"
    [data]="confirmationPopup().data"
    (confirmed)="onDeleteConfirmed()"
    (cancelled)="onDeleteCancelled()"
  />
</div>
