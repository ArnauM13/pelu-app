<pelu-popup-dialog
  [isOpen]="isOpen()"
  [config]="dialogConfig()"
  (closed)="onClose()"
>
  @if (isLoading()) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>{{ 'COMMON.LOADING' | translate }}</p>
    </div>
  } @else if (loadError()) {
    <div class="error-container">
      <div class="error-icon">‚ùå</div>
      <h3>{{ 'COMMON.ERROR' | translate }}</h3>
      <p>{{ 'COMMON.ERROR_LOADING_BOOKING' | translate }}</p>
    </div>
  } @else if (currentBooking()) {
    <div class="booking-info">
      <div class="client-section">
        <h3>{{ 'COMMON.CLIENT_INFORMATION' | translate }}</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.NAME' | translate }}:</span>
            <span class="info-value">{{ getClientName(currentBooking()!) }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.EMAIL' | translate }}:</span>
            <span class="info-value">{{ getClientEmail(currentBooking()!) }}</span>
          </div>
        </div>
      </div>

      <div class="booking-section">
        <h3>{{ 'COMMON.BOOKING_INFORMATION' | translate }}</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.DATE' | translate }}:</span>
            <span class="info-value">{{ formatBookingDate(currentBooking()!.data || '') }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.HOURS' | translate }}:</span>
            <span class="info-value">{{ currentBooking()!.hora || '' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.SERVICE' | translate }}:</span>
            <span class="info-value">{{ getServiceName(currentBooking()!) }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.DURATION' | translate }}:</span>
            <span class="info-value">{{ formatDuration(currentBooking()!.duration || 60) }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">{{ 'COMMON.PRICE' | translate }}:</span>
            <span class="info-value">{{ formatPrice(currentBooking()!.price || 0) }}</span>
          </div>
        </div>
      </div>

      @if (currentBooking()!.notes) {
        <div class="notes-section">
          <h3>{{ 'COMMON.NOTES' | translate }}</h3>
          <p class="notes-text">{{ currentBooking()!.notes }}</p>
        </div>
      }
    </div>
  }

  <!-- Confirmation Popup -->
  <pelu-confirmation-popup
    [isOpen]="showConfirmationPopup()"
    [data]="confirmationData()"
    (confirmed)="onConfirmationConfirmed()"
    (cancelled)="onConfirmationCancelled()"
  >
  </pelu-confirmation-popup>
</pelu-popup-dialog>
