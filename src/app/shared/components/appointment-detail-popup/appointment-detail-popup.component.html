@if (open()) {
<div class="appointment-detail-popup-overlay"
     [class.closing]="isClosingState()"
     (click)="onBackdropClick($event)">
  <div class="appointment-detail-popup"
       [class.closing]="isClosingState()">
    <!-- Header -->
    <div class="popup-header">
      <div class="header-content">
        <h3>{{ 'APPOINTMENTS.APPOINTMENT_DETAIL' | translate }}</h3>
      </div>
      <button class="close-btn" (click)="onClose()" [title]="'COMMON.ACTIONS.CLOSE' | translate">
        <i class="pi pi-times"></i>
      </button>
    </div>

    <!-- Body -->
    <div class="popup-body">
      @if (appointment(); as cita) {
        <!-- Appointment Info -->
        <div class="appointment-info">
          @for (item of appointmentInfoItems(); track item.label) {
            <div class="info-row">
              <div class="info-label">{{ item.label }}</div>
              <div class="info-value">{{ item.value }}</div>
            </div>
          }
        </div>

        <!-- Status Badge -->
        <div class="status-section">
          <pelu-appointment-status-badge
            [appointmentData]="{ date: appointmentDate(), time: appointment()?.hora }"
            [config]="{ size: 'medium', variant: 'default', showIcon: true, showDot: false }">
          </pelu-appointment-status-badge>
        </div>

        <!-- Actions -->
        @if (!hideViewDetailButton()) {
        <div class="popup-actions">
          <div class="actions-row">
            <button
              class="btn btn-primary"
              (click)="onViewFullDetail()"
              [title]="'APPOINTMENTS.VIEW_FULL_DETAIL' | translate">
              üëÅÔ∏è {{ 'APPOINTMENTS.VIEW_FULL_DETAIL' | translate }}
            </button>
            <button
              class="btn btn-secondary"
              (click)="onEditAppointment()"
              [title]="'COMMON.ACTIONS.EDIT' | translate">
              ‚úèÔ∏è {{ 'COMMON.ACTIONS.EDIT' | translate }}
            </button>
            <button
              class="btn btn-danger"
              (click)="onDeleteAppointment()"
              [title]="'COMMON.ACTIONS.DELETE' | translate">
              üóëÔ∏è {{ 'COMMON.ACTIONS.DELETE' | translate }}
            </button>
          </div>
        </div>
        }
      } @else {
        <div class="no-appointment">
          <p>{{ 'APPOINTMENTS.NOT_FOUND' | translate }}</p>
        </div>
      }
    </div>
  </div>
</div>
}
