<p-toast key="booking-toast" position="top-right" [baseZIndex]="9999" (onClick)="onToastClick($event)">
  <ng-template let-message pTemplate="message">
    <div class="p-toast-message-content">
      <div class="p-toast-message-icon">
        <i [class]="message.severity === 'success' ? 'pi pi-check' : message.severity === 'error' ? 'pi pi-times' : message.severity === 'warn' ? 'pi pi-exclamation-triangle' : 'pi pi-info-circle'"></i>
      </div>
      <div class="p-toast-message-text">
        <span class="p-toast-summary">{{ message.summary }}</span>
        <div class="p-toast-detail">{{ message.detail }}</div>
        @if (message.data?.showViewButton && message.data?.appointmentId) {
        <div class="p-toast-message-actions">
          <button
            class="p-toast-message-btn p-toast-message-btn-primary"
            (click)="viewAppointmentDetail(message.data.appointmentId); $event.stopPropagation()">
            üëÅÔ∏è Veure detall
          </button>
        </div>
        }
      </div>
      <button class="p-toast-icon-close" (click)="messageService.clear('booking-toast'); $event.stopPropagation()">
        <i class="pi pi-times"></i>
      </button>
    </div>
  </ng-template>
</p-toast>

<div class="container" style="margin-top: 2rem; view-transition-name: booking-container">
  <div class="booking-layout" style="margin-bottom: 2rem; view-transition-name: booking-grid">
    <!-- Calendar Section - Full Width -->
    <pelu-calendar-component
      [events]="events()"
      [mini]="false"
      (dateSelected)="onDateSelected($event)" />

    <!-- Manual Booking Section - Commented Out -->
    <!--
    <pelu-card class="manual-booking-section" style="view-transition-name: manual-booking-card">
      <h2 style="margin-top: 0;">{{ 'COMMON.MANUAL_BOOKING' | translate }}</h2>
      <div class="form-group">
        <label for="nom">{{ 'COMMON.CLIENT_NAME' | translate }}:</label>
        <input
          type="text"
          id="nom"
          [value]="nouClient().nom"
          (input)="updateNom($any($event.target).value)"
          [placeholder]="'COMMON.ENTER_CLIENT_NAME' | translate"
          class="input">
      </div>

      <div class="form-group">
        <label for="data">{{ 'COMMON.DATE' | translate }}:</label>
        <input
          type="date"
          id="data"
          [value]="nouClient().data"
          (input)="updateData($any($event.target).value)"
          class="input">
      </div>

      <div class="form-group">
        <label for="hora">{{ 'COMMON.TIME' | translate }}:</label>
        <input
          type="time"
          id="hora"
          [value]="nouClient().hora"
          (input)="updateHora($any($event.target).value)"
          class="input">
      </div>

      <button
        class="btn btn-primary"
        (click)="afegirCita()"
        [disabled]="!canAddAppointment()">
        {{ 'COMMON.ADD_BOOKING' | translate }}
      </button>
    </pelu-card>
    -->
  </div>
</div>

<!-- Booking Confirmation Popup -->
<pelu-booking-popup
  [open]="showBookingPopup()"
  [bookingDetails]="bookingDetails()"
  (confirmed)="onBookingConfirmed($event)"
  (cancelled)="onBookingCancelled()"
  (clientNameChanged)="onBookingClientNameChanged($event)">
</pelu-booking-popup>
