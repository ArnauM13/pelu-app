<p-toast></p-toast>

<div class="container" style="margin-top: 2rem;">
  <div class="grid grid-2" style="margin-bottom: 2rem;">
    <!-- Calendar Section -->
    <pelu-card>
      <h2 style="margin-top: 0;">{{ 'COMMON.CALENDAR_BOOKING' | translate }}</h2>
      <pelu-calendar-component
        [events]="events()"
        [mini]="true"
        (dateSelected)="onDateSelected($event)" />
    </pelu-card>

    <!-- Manual Booking Section -->
    <pelu-card>
      <h2 style="margin-top: 0;">{{ 'COMMON.MANUAL_BOOKING' | translate }}</h2>
      <div class="form-group">
        <label for="nom">{{ 'COMMON.CLIENT_NAME' | translate }}:</label>
        <input
          type="text"
          id="nom"
          [value]="nouClient().nom"
          (input)="updateNom($any($event.target).value)"
          [placeholder]="'COMMON.ENTER_CLIENT_NAME' | translate"
          class="input">
      </div>

      <div class="form-group">
        <label for="data">{{ 'COMMON.DATE' | translate }}:</label>
        <input
          type="date"
          id="data"
          [value]="nouClient().data"
          (input)="updateData($any($event.target).value)"
          class="input">
      </div>

      <div class="form-group">
        <label for="hora">{{ 'COMMON.TIME' | translate }}:</label>
        <input
          type="time"
          id="hora"
          [value]="nouClient().hora"
          (input)="updateHora($any($event.target).value)"
          class="input">
      </div>

      <button
        class="btn btn-primary"
        (click)="afegirCita()"
        [disabled]="!canAddAppointment()">
        {{ 'COMMON.ADD_BOOKING' | translate }}
      </button>
    </pelu-card>
  </div>
</div>

<!-- Booking Confirmation Popup -->
@if (showBookingPopup()) {
<div class="booking-popup-overlay" (click)="closeBookingPopup()">
  <div class="booking-popup" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <h3>{{ 'COMMON.BOOKING_CONFIRMATION' | translate }}</h3>
      <button class="close-btn" (click)="closeBookingPopup()">Ã—</button>
    </div>

    <div class="popup-body">
      <div class="booking-info">
        <div class="info-row">
          <span class="label">{{ 'COMMON.DATE' | translate }}:</span>
          <span class="value">{{ formatDate(bookingDetails().date) }}</span>
        </div>
        <div class="info-row">
          <span class="label">{{ 'COMMON.TIME' | translate }}:</span>
          <span class="value">{{ bookingDetails().time }}</span>
        </div>
      </div>

      <div class="form-group">
        <label for="clientName">{{ 'COMMON.CLIENT_NAME' | translate }}:</label>
        <input
          type="text"
          id="clientName"
          [value]="bookingDetails().clientName"
          (input)="updateBookingClientName($any($event.target).value)"
          [placeholder]="'COMMON.ENTER_CLIENT_NAME' | translate"
          class="form-input"
          (keyup.enter)="confirmBooking()"
          autofocus>
      </div>
    </div>

    <div class="popup-footer">
      <button class="btn btn-secondary" (click)="closeBookingPopup()">{{ 'COMMON.CANCEL' | translate }}</button>
      <button
        class="btn btn-primary"
        (click)="confirmBooking()"
        [disabled]="!canConfirmBooking()">
        {{ 'COMMON.CONFIRM_BOOKING' | translate }}
      </button>
    </div>
  </div>
</div>
}
